%-- Experiment 1: Pulling forces on cantilever beam with gravity
%-- The experiment will be performed with a static value alpha = 1.0, which
%-- means that the beam should stay in its position at the end of the
%-- simulation. Meanwhile, gravitational forces will also be affecting the
%-- robot, which means that the cable forces need to be quite large to
%-- overcome gravity.
%-- Both ends of the robots are fastened to invisible infinite mass walls,
%-- which means that for the experiment to be successful, the robot should
%-- not be affected by gravity at all (or at least very little.

clear all;
close all;
clc;
% Add libraries
addpath('../fem');
addpath('../meshing');
addpath('../simulate');
addpath('../simulate/pull');
% Use a FEM method for simulating cable forces
method = fem_method();
% The cable that will be embedded in the beam mesh
cable = [-59  , 0.0, 0.0; ...
         -30, 0, 0; ...
         0.0, 0.0, 0.0; ...
         30, 0, 0; ...
         59, 0.0, 0.0]; 
% Create the scene for the simulation
scene  = pull_create_scene(1, '../', cable, true, 'model1.12.mat');
% Create the parameters for 'ecoflex-00-50' silicone, and use an adaptive
% step in the simulation
params = create_params('ecoflex-00-50','adaptive', 10.0, 0.001, false, true, 50, 1e9, true); 
%params.E = 5000;
params.k = 1e5;
% Create profile info
pinfo  = create_profile_info();
pinfo.output_path = '../output/exp_pull_2/';
% Data generated by the simulation
pdata = simulate( params, method, scene, pinfo); 
save('exp_pull_2_pdata.mat', 'pdata');
save('exp_pull_2_pinfo.mat', 'pinfo');
% Process the data
postprocess(pinfo,pdata)