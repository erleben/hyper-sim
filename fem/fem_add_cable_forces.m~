function [ state ] = fem_add_cable_forces( state, cable_info )
% Copyright 2011, Kenny Erleben
% Modified by Max Kragballe, 2019

%--- Get cable info -------------------------------------------------------
Fp = cable_info.Fp;     %-- Cable forces at the via points
W = cable_info.W;       %-- Barycentric weighting of via point positions

%--- Compute the nodal forces by solving
%       Fp = W Fv =>
%       W^T Fp = W^TW Fv =>
%       

% Add the forces to the correct nodes
for i=1:length(Fx(:,1))
  state.fx(i) = state.fx(i) + Fx(i);
  state.fy(i) = state.fy(i) + Fy(i);
  state.fz(i) = state.fz(i) + Fz(i);
end

end